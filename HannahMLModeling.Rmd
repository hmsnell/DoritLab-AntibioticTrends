---
title: "MLWork"
author: "Hannah Snell"
date: "2/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(tidyverse)
```

# Data Preparation 

## Resistance Data 

```{r}
resistance_state <- read.csv("Resist_States.csv")
resistance_region <- read.csv("Resist_Regional.csv")
resistance_national <- read.csv("Resist_National.csv")
```

## Outpatient Antibiotic Use Data 

```{r}
antibiotic_use <- read.csv("Outpatient_Antibiotic_Use.csv") 
antibiotic_use <- antibiotic_use %>% 
  mutate(State = recode(Location, 
                           "Alabama" = "AL",
                           "Alaska" = "AK",
                           "Arizona" = "AZ",
                           "Arkansas" = "AR",
                           "California" = "CA",
                           "Colorado" = "CO",
                           "Connecticut" = "CT",
                           "Delaware" = "DE",
                           "District Of Columbia" = "DC",
                           "Florida" = "FL",
                           "Georgia" = "GA",
                           "Hawaii" = "HI",
                           "Idaho" = "ID",
                           "Illinois" = "IL",
                           "Indiana" = "IN", 
                           "Iowa" = "IA",
                           "Kansas" = "KS",
                           "Kentucky" = "KY",
                           "Louisiana" = "LA", 
                           "Maine" = "ME",
                           "Maryland" = "MD",
                           "Massachusetts" = "MA",
                           "Michigan" = "MI",
                           "Minnesota" = "MN",
                           "Mississippi" = "MS",
                           "Missouri" = "MO",
                           "Montana" = "MT",
                           "Nebraska" = "NE",
                           "Nevada" = "NV",
                           "New Hampshire" = "NH",
                           "New Jersey" = "NJ",
                           "New Mexico" = "NM",
                           "New York" = "NY",
                           "North Carolina" = "NC",
                           "North Dakota" = "ND",
                           "Ohio" = "OH",
                           "Oklahoma" = "OK",
                           "Oregon" = "OR",
                           "Pennsylvania" = "PA",
                           "Rhode Island" = "RI",
                           "South Carolina" = "SC",
                           "South Dakota" = "SD",
                           "Tennessee" = "TN",
                           "Texas" = "TX",
                           "Utah" = "UT",
                           "Vermont" = "VT",
                           "Virginia" = "VA",
                           "Washington" = "WA",
                           "West Virginia" = "WV",
                           "Wisconsin" = "WI",
                           "Wyoming" = "WY"))

```


## IsolateData-2 Set 

```{r}
IsolateData_2 %>% distinct(Species)

# So there are 11 unique species --> This will be easy to work with and make some EDA viz
```

## EDA 

### Enterica
```{r}
isolate_enterica <- IsolateData_2 %>% 
  filter(Species == "enterica") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) %>% 
  filter(ResistCount >= 100) %>% 
  mutate(logResist = log10(ResistCount))

  
testviz1 <- ggplot(data = isolate_enterica, aes(x = `Resistance Pattern`, y = logResist)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz1
  

```


### Jejuni

```{r}
isolate_jejuni <- IsolateData_2 %>% 
  filter(Species == "jejuni") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) %>% 
  filter(ResistCount >= 100) %>% 
  mutate(logResist = log10(ResistCount))

  
testviz2 <- ggplot(data = isolate_jejuni, aes(x = `Resistance Pattern`, y = logResist)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz2
```

### Flexneri 

```{r}
isolate_flexneri <- IsolateData_2 %>% 
  filter(Species == "flexneri") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) %>% 
  filter(ResistCount >= 100) %>% 
  mutate(logResist = log10(ResistCount))

  
testviz3 <- ggplot(data = isolate_flexneri, aes(x = `Resistance Pattern`, y = logResist)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz3
```

### Sonnei 

```{r}
isolate_sonnei <- IsolateData_2 %>% 
  filter(Species == "sonnei") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) %>% 
  filter(ResistCount >= 100) %>% 
  mutate(logResist = log10(ResistCount))

  
testviz4 <- ggplot(data = isolate_sonnei, aes(x = `Resistance Pattern`, y = logResist)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz4
```


### Coli 

```{r}
isolate_coli <- IsolateData_2 %>% 
  filter(Species == "coli") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) %>% 
  filter(ResistCount >= 100) %>% 
  mutate(logResist = log10(ResistCount))

  
testviz5 <- ggplot(data = isolate_coli, aes(x = `Resistance Pattern`, y = logResist)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz5
```

### Boydii 

```{r}
isolate_boydii <- IsolateData_2 %>% 
  filter(Species == "boydii") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) %>% 
  #filter(ResistCount >= 100) %>% 
  mutate(logResist = log10(ResistCount))

  
testviz6 <- ggplot(data = isolate_boydii, aes(x = `Resistance Pattern`, y = logResist)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz6

# NOTE: Did not filter for 100+ occurrences! 
```

### Unknown

```{r}
isolate_unknown <- IsolateData_2 %>% 
  filter(Species == "unknown") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) %>% 
  #filter(ResistCount >= 100) %>% 
  mutate(logResist = log10(ResistCount))

  
testviz7 <- ggplot(data = isolate_unknown, aes(x = `Resistance Pattern`, y = logResist)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz7

# NOTE: Did not filter for 100+ occurrences! 
```

### Dysenteriae

```{r}
isolate_dysenteriae <- IsolateData_2 %>% 
  filter(Species == "dysenteriae") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) %>% 
  #filter(ResistCount >= 100) %>% 
  mutate(logResist = log10(ResistCount))

  
testviz8 <- ggplot(data = isolate_dysenteriae, aes(x = `Resistance Pattern`, y = logResist)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz8
```

### Provisional

```{r}
isolate_provisional <- IsolateData_2 %>% 
  filter(Species == "provisional") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) 
  #filter(ResistCount >= 100) %>% 
  #mutate(logResist = log10(ResistCount))

  
testviz9 <- ggplot(data = isolate_provisional, aes(x = `Resistance Pattern`, y = ResistCount)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz9
```

### Other

```{r}
isolate_other <- IsolateData_2 %>% 
  filter(Species == "other") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) 
  #filter(ResistCount >= 100) %>% 
  #mutate(logResist = log10(ResistCount))

  
testviz10 <- ggplot(data = isolate_other, aes(x = `Resistance Pattern`, y = ResistCount)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz10
```

### Bongori

```{r}
isolate_bongori <- IsolateData_2 %>% 
  filter(Species == "bongori") %>% 
  group_by(`Resistance Pattern`) %>% 
  mutate(ResistCount = n()) 
  #filter(ResistCount >= 100) %>% 
  #mutate(logResist = log10(ResistCount))

  
testviz11 <- ggplot(data = isolate_bongori, aes(x = `Resistance Pattern`, y = ResistCount)) + geom_col() + theme(axis.text.x = element_text(angle = 90))
testviz11
```







